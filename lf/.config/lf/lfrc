set shell zsh
set shellopts '-euy'
set ifs "\n"
set icons
set drawbox
set period 1
set ratios 1:2

set previewer "~/.config/lf/preview"
set cleaner "~/.config/lf/clear"

cmd play ${{
  case $(file --mime-type "$(readlink -f $f)" -b) in
    audio/x-wav) aplay -D pulse -q "$f" &;;
  esac
}}

cmd open ${{
  case $(file --mime-type "$(readlink -f $f)" -b) in
    text/*|application/json|inode/x-empty|application/x-subrip) $EDITOR $fx;;
    audio/*|video/x-ms-asf) mpv --audio-display=no $f ;;
    video/*) mpv --fs --really-quiet $f;;
    image/*) nsxiv -fab -s f $f;;
    application/pdf|application/vnd.djvu|application/epub*) setsid -f zathura $fx >/dev/null 2>&1 ;;
    *) for f in $fx; do setsid -f $OPENER $f >/dev/null 2>&1; done;;
  esac
}}

cmd moveto %mv $fx "$1"
cmd copyto %cp -r $fx "$1"
cmd setwallpaper "$1"
cmd mkdir %mkdir -p -- "$@"

map P play
map D delete
map b $setwallpaper $f
map a push :mkdir<space>
map M
map M push :moveto<space>
map Y push :copyto<space>
